<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ include file="/commons/comm_cons_tag.jsp"%> 
<%@ include file="/commons/comm_css.jsp"%>  
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>商品图片关联</title>
</head>
<body>
<div class="layui-layout layui-layout-admin">
 <%@ include file="/commons/common_layout.jsp"%>
 <div class="layui-tab layui-tab-brief layui-form"  >
	<ul class="layui-tab-title site-title">
     	<li class="layui-this" >商品图片关联</li>
	</ul>
	<div class="layui-body layui-tab-content site site-body site-custom-body layui-form-item" >
		<div class="layui-tab-item layui-show "   >
			<blockquote class="layui-elem-quote">请上传ZIP压缩包,系统将自动为您解压文件</blockquote>
				<form id="form" action="goods/relevanceGoodsImg" method="post" >
				<div class="layui-input-inline" style="margin-top: 30px;" >
					<input type="file" name="file" id="uploadFile" class="layui-upload-file" lay-title="上传zip压缩包"> 
					<input type="hidden" name="zipFile" id="zipFile" value="">
				</div>
				</form>
			
		</div>
		<div class="layui-form"  style="margin-top: 120px;">
			<input type="button" id="save" class="layui-btn" value="确认" /> 
		</div>
	</div> 
 </div>
 <%@ include file="/commons/buttom.jsp"%>
</div> 
	
</body>
<script type="text/javascript">
layui.use(["pager","form","upload"],function(){
	var tool = layui.tool ,$ = layui.jquery ,pager = layui.pager ,form = layui.form();
	console.log(tool.getFullDate(new Date())) ;
	
	layui.upload({
	    url: 'fileUpload/uploadZip' //上传接口
	    ,ext: 'zip'
	    ,success: function(res){ //上传成功后的回调]
	    	var result = res.data;
	      	if(  result.success == true ){
	      		 $("#zipFile").val(result.filePath);
	      		 $("#uploadFile").attr('lay-title',"上传成功");
	      		 tool.info("上传成功 ， 点击确认将会自动关联图片");
	      	}else{
	      		 tool.warning(result.msg);
	      	}
	    }
	 });
	
	
	$("#save").click(function (){
		if($("#zipFile").val() == ''){
			tool.warning("请先上传图片压缩包");
		}else{ 
			$.ajax({
		        type: "POST",
		        dataType: "html",
		        url: "goods/relevanceGoodsImg",
		        data: $("#form").serialize(),
		        dataType: "JSON",
		        success: function (data) {
		       		 var result = data.data;
		       		 if( result.success == true ){
		       			 tool.info("图片关联成功");
		       		} else {
		       			tool.warning(result.message);
		       		}  
		        }
			})  
		}
	});
   	 
});
</script>

</html>